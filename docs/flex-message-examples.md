# üé® ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Flex Message - Wazuh MOPH Notify Integration


## üé® ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Flex Message

LINE Flex Message ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Wazuh MOPH Notify Integration ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Flex Message ‡∏ó‡∏µ‡πà:

- üö¶ **‡πÅ‡∏¢‡∏Å‡∏™‡∏µ‡∏ï‡∏≤‡∏° Priority** - ‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- üìä **‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° Level** - Level ‡∏™‡∏π‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
- üéØ **Responsive Design** - ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏•‡∏∞ Desktop
- üõ†Ô∏è **Customizable** - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

### Priority Level ‡πÅ‡∏•‡∏∞‡∏™‡∏µ

| Level | Priority | ‡∏™‡∏µ Header | Emoji | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
|-------|----------|-----------|-------|-----------|
| 15+ | CRITICAL | `#8B0000` (‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏°) | üö®üî• | ‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô - ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ |
| 12+ | HIGH | `#DC143C` (‡πÅ‡∏î‡∏á‡∏™‡∏î) | üö®üî¥ | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á - 15 ‡∏ô‡∏≤‡∏ó‡∏µ |
| 7+ | MEDIUM | `#FF6347` (‡∏™‡πâ‡∏°‡πÅ‡∏î‡∏á) | ‚ö†Ô∏èüü° | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á - 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á |
| 3+ | LOW | `#32CD32` (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏î) | ‚ÑπÔ∏èüü¢ | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≥ - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° |
| 0+ | INFO | `#4169E1` (‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î) | üìãüîµ | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå |

---

## üî• ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏° Priority Level

### 1. CRITICAL Alert (Level 15+)

```
üö®üî• Wazuh Security Alert
CRITICAL ALERT
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã Critical system compromise detected - Multiple rootkit signatures found

‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:          15 (CRITICAL)
üñ•Ô∏è Agent:          production-server-01  
üî¢ Rule ID:         510002
üåê Source IP:       10.0.1.50

üìÑ Log Details:
Jan 18 14:30:22 production-server-01 kernel: [malware] Suspicious rootkit activity detected in /usr/lib/systemd. Multiple system files modified. Immediate investigation required...

‚è∞ 2025-01-18 14:30:22 UTC

üÜò ‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ! ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏° SOC
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**:
- Header ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° (#8B0000)
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô
- Log details ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ï‡πá‡∏° (400 characters)
- Footer ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô

---

### 2. HIGH Alert (Level 12+)

```
üö®üî¥ Wazuh Security Alert  
HIGH PRIORITY
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã Multiple authentication failures from same source IP

‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:          12 (HIGH)
üñ•Ô∏è Agent:          web-server-01
üî¢ Rule ID:         5712  
üåê Source IP:       192.168.1.100

üìÑ Log Details:
Dec 18 10:30:00 web-server-01 sshd[1234]: Failed password for admin from 192.168.1.100 port 22 ssh2. This is the 5th consecutive failed attempt from this IP address within 10 minutes...

‚è∞ 2025-01-18 10:30:00 UTC

üöÄ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡πà‡∏ß‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**:
- Header ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏™‡∏î (#DC143C)
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏£‡∏ß‡∏° Rule ID ‡πÅ‡∏•‡∏∞ Source IP
- Log details ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (300 characters)
- Footer ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£

---

### 3. MEDIUM Alert (Level 7+)

```
‚ö†Ô∏èüü° Wazuh Security Alert
MEDIUM PRIORITY  
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã SSH login from unusual location

‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:          8 (MEDIUM)
üñ•Ô∏è Agent:          app-server-02
üî¢ Rule ID:         5501
üåê Source IP:       203.0.113.25

üìÑ Log Details:
Jan 18 09:15:30 app-server-02 sshd[5678]: Accepted publickey for user from 203.0.113.25 port 45123 ssh2...

‚è∞ 2025-01-18 09:15:30 UTC

‚è∞ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**:
- Header ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÅ‡∏î‡∏á (#FF6347)
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- Log details ‡∏™‡∏±‡πâ‡∏ô‡∏Å‡∏ß‡πà‡∏≤ (200 characters)
- Footer ‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á

---

### 4. LOW Alert (Level 3+)

```
‚ÑπÔ∏èüü¢ Wazuh Security Alert
LOW PRIORITY
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã User logged in successfully

‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:          5 (LOW)
üñ•Ô∏è Agent:          office-workstation-05
üî¢ Rule ID:         5502
üåê Source IP:       192.168.10.25

‚è∞ 2025-01-18 08:45:15 UTC

üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**:
- Header ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏î (#32CD32)
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ Log details
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡πâ‡∏ô‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö (150 characters)
- Footer ‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

---

### 5. INFO Alert (Level 0+)

```
üìãüîµ Wazuh Security Alert
INFORMATION
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã System backup completed successfully

‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:          3 (INFO)
üñ•Ô∏è Agent:          backup-server-01

‚è∞ 2025-01-18 02:00:00 UTC

üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**:
- Header ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (#4169E1)
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‡πÑ‡∏°‡πà‡∏°‡∏µ Rule ID, Source IP, Log details
- Footer ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå

---

## üèóÔ∏è ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Flex Message

### Component Layout

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           HEADER                ‚îÇ  ‚Üê Priority-based color + emoji
‚îÇ   üö®üî¥ Wazuh Security Alert    ‚îÇ
‚îÇ     HIGH PRIORITY               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ           BODY                  ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ üìã Alert Description           ‚îÇ  ‚Üê Main alert info
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ     ‚îÇ
‚îÇ ‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:    12 (HIGH)         ‚îÇ  ‚Üê Level & Priority
‚îÇ üñ•Ô∏è Agent:    web-server-01     ‚îÇ  ‚Üê Agent name
‚îÇ üî¢ Rule ID:  5712              ‚îÇ  ‚Üê Rule ID (if available)
‚îÇ üåê Source IP: 192.168.1.100    ‚îÇ  ‚Üê Source IP (if available)
‚îÇ                                 ‚îÇ
‚îÇ üìÑ Log Details:                ‚îÇ  ‚Üê Log section (if available)
‚îÇ Failed password for admin...    ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ ‚è∞ 2025-01-18 10:30:00 UTC     ‚îÇ  ‚Üê Timestamp
‚îÇ                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ           FOOTER                ‚îÇ  ‚Üê Action guidance
‚îÇ üöÄ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡πà‡∏ß‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### JSON Structure

```json
{
  "type": "flex",
  "altText": "üö® Wazuh Alert: Alert description...",
  "contents": {
    "type": "bubble",
    "size": "kilo",
    "header": {
      "type": "box",
      "layout": "vertical", 
      "backgroundColor": "#DC143C",
      "contents": [...]
    },
    "body": {
      "type": "box",
      "layout": "vertical",
      "contents": [...]
    },
    "footer": {
      "type": "box", 
      "layout": "vertical",
      "backgroundColor": "#F8F9FA",
      "contents": [...]
    }
  }
}
```

---

## üé® ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Design

### 1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ Header

```python
# ‡πÉ‡∏ô custom-moph-notify.py, ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç header_colors
header_colors = {
    "CRITICAL": "#B22222",    # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏≠‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô
    "HIGH": "#FF4500",        # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÅ‡∏î‡∏á
    "MEDIUM": "#FFA500",      # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏™‡πâ‡∏°
    "LOW": "#228B22",         # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏°
    "INFO": "#4682B4"         # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏°
}
```

### 2. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Emoji ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

```python
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç priority_config
priority_config = {
    "CRITICAL": {
        "emoji": "üî¥üí•",      # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô emoji
        "footer": "üÜò URGENT: Contact SOC immediately!",
        "urgency": "CRITICAL ALERT"
    },
    "HIGH": {
        "emoji": "üü†‚ö°", 
        "footer": "‚ö° Action required within 30 minutes",
        "urgency": "HIGH PRIORITY"
    }
    # ... ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
}
```

### 3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Action Buttons

```python
# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô footer section
"footer": {
    "type": "box",
    "layout": "vertical",
    "contents": [
        {
            "type": "text",
            "text": footer_msg,
            "size": "sm",
            "color": "#666666",
            "wrap": True
        },
        {
            "type": "box",
            "layout": "horizontal",
            "margin": "md",
            "contents": [
                {
                    "type": "button",
                    "style": "primary",
                    "color": "#FF0000",
                    "action": {
                        "type": "uri",
                        "uri": f"https://wazuh-dashboard.yourorg.com/app/wazuh#/manager/rules?tab=rules&redirectRule={alert_data['rule_id']}"
                    },
                    "text": "View Rule"
                },
                {
                    "type": "button", 
                    "style": "secondary",
                    "action": {
                        "type": "uri",
                        "uri": f"https://wazuh-dashboard.yourorg.com/app/wazuh#/agents?tab=welcome&agent={alert_data['agent']}"
                    },
                    "text": "View Agent"
                }
            ]
        }
    ]
}
```

### 4. ‡πÄ‡∏û‡∏¥‡πà‡∏° Hero Image

```python
# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô bubble structure ‡∏´‡∏•‡∏±‡∏á header
"hero": {
    "type": "image",
    "url": "https://your-cdn.com/wazuh-alert-icon.png",
    "size": "sm",
    "aspectRatio": "20:13",
    "aspectMode": "cover"
}
```

---

## üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á JSON Output

### CRITICAL Alert JSON

```json
{
  "type": "flex",
  "altText": "üö® Wazuh Alert: Critical system compromise detected...",
  "contents": {
    "type": "bubble",
    "size": "kilo",
    "header": {
      "type": "box",
      "layout": "vertical",
      "backgroundColor": "#8B0000",
      "paddingAll": "16px",
      "contents": [
        {
          "type": "text",
          "text": "üö®üî• Wazuh Security Alert",
          "color": "#FFFFFF",
          "weight": "bold",
          "size": "lg",
          "wrap": true
        },
        {
          "type": "text",
          "text": "CRITICAL ALERT",
          "color": "#FFFFFF",
          "size": "sm",
          "margin": "sm",
          "weight": "bold"
        }
      ]
    },
    "body": {
      "type": "box",
      "layout": "vertical",
      "contents": [
        {
          "type": "text",
          "text": "üìã Critical system compromise detected - Multiple rootkit signatures found",
          "wrap": true,
          "weight": "bold",
          "margin": "md",
          "size": "md",
          "color": "#333333"
        },
        {
          "type": "separator",
          "margin": "md",
          "color": "#E0E0E0"
        },
        {
          "type": "box",
          "layout": "horizontal",
          "contents": [
            {
              "type": "text",
              "text": "‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö:",
              "size": "sm",
              "color": "#888888",
              "flex": 3,
              "weight": "bold"
            },
            {
              "type": "text",
              "text": "15 (CRITICAL)",
              "size": "sm",
              "color": "#8B0000",
              "flex": 5,
              "wrap": true,
              "weight": "bold"
            }
          ],
          "margin": "sm"
        }
        // ... ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
      ],
      "paddingAll": "16px",
      "spacing": "sm"
    },
    "footer": {
      "type": "box",
      "layout": "vertical",
      "backgroundColor": "#F8F9FA",
      "paddingAll": "14px",
      "contents": [
        {
          "type": "text",
          "text": "üÜò ‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ! ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏° SOC",
          "size": "sm",
          "color": "#666666",
          "wrap": true,
          "weight": "bold"
        }
      ]
    },
    "styles": {
      "header": {
        "separator": false
      },
      "body": {
        "separator": false
      },
      "footer": {
        "separator": true,
        "separatorColor": "#E0E0E0"
      }
    }
  }
}
```

---

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Flex Message

### 1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Sample Alerts

```bash
# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ level
cat > /tmp/test_critical.json << 'EOF'
{
    "timestamp": "2025-01-18T14:30:22.000+0000",
    "rule": {
        "level": 15,
        "description": "Critical system compromise detected - Multiple rootkit signatures found",
        "id": "510002"
    },
    "agent": {
        "name": "production-server-01"
    },
    "data": {
        "srcip": "10.0.1.50"
    },
    "full_log": "Jan 18 14:30:22 production-server-01 kernel: [malware] Suspicious rootkit activity detected in /usr/lib/systemd. Multiple system files modified. Immediate investigation required."
}
EOF

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö
sudo /var/ossec/integrations/custom-moph-notify /tmp/test_critical.json dummy https://morpromt2f.moph.go.th/api/notify/send
```

### 2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

```bash
# ‡∏™‡∏£‡πâ‡∏≤‡∏á alert ‡∏ó‡∏µ‡πà‡∏°‡∏µ log ‡∏¢‡∏≤‡∏ß‡∏°‡∏≤‡∏Å
cat > /tmp/test_long_message.json << 'EOF'
{
    "timestamp": "2025-01-18T10:30:00.000+0000",
    "rule": {
        "level": 10,
        "description": "Test long message truncation",
        "id": "99999"
    },
    "agent": {
        "name": "test-server"
    },
    "full_log": "This is a very long log message that should be truncated by the smart truncation function. It contains multiple sentences and should be cut at an appropriate point. The system should find the best place to cut this message, preferably at a sentence boundary or at least at a word boundary. This message is intentionally long to test the truncation functionality and ensure that it works properly in all scenarios."
}
EOF

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö
sudo /var/ossec/integrations/custom-moph-notify /tmp/test_long_message.json dummy https://morpromt2f.moph.go.th/api/notify/send
```

### 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö JSON Structure

```bash
# ‡πÄ‡∏û‡∏¥‡πà‡∏° debug output ‡πÉ‡∏ô script ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π JSON structure
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô custom-moph-notify.py:

# ‡∏Å‡πà‡∏≠‡∏ô send_to_moph_notify() ‡πÄ‡∏û‡∏¥‡πà‡∏°:
print("üîç Debug: Flex Message JSON Structure:")
print(json.dumps(flex_message, indent=2, ensure_ascii=False))
```

### 4. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ö LINE Flex Message Simulator

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Flex Message Simulator](https://developers.line.biz/flex-simulator/)
2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å JSON ‡∏Ç‡∏≠‡∏á Flex Message ‡∏à‡∏≤‡∏Å debug output
3. ‡∏ß‡∏≤‡∏á JSON ‡πÉ‡∏ô simulator
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

---

## üì± Responsive Design Considerations

### Mobile View
- Text size ‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- 2-column layout ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡∏µ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å
- Long text wrap properly
- Separator lines ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô

### Desktop/Web View  
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û
- Font size ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô
- Better spacing ‡πÅ‡∏•‡∏∞ padding
- Action buttons ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô

### Accessibility
- High contrast colors
- Clear font sizes
- Semantic text structure
- Alt text ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö images (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

---

## üîß Advanced Customization

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Conditional Logic

```python
def create_advanced_flex_message(alert_data, severity_info):
    # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ï‡∏≤‡∏° alert type
    if "authentication" in alert_data['description'].lower():
        # ‡πÉ‡∏ä‡πâ template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö auth alerts
        return create_auth_flex_message(alert_data, severity_info)
    elif "malware" in alert_data['description'].lower():
        # ‡πÉ‡∏ä‡πâ template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö malware alerts  
        return create_malware_flex_message(alert_data, severity_info)
    else:
        # ‡πÉ‡∏ä‡πâ template ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
        return create_default_flex_message(alert_data, severity_info)
```

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Rich Content

```python
# ‡πÄ‡∏û‡∏¥‡πà‡∏° progress bar ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö severity
def add_severity_progress_bar(level):
    max_level = 15
    progress = min(int(level) / max_level * 100, 100)
    
    return {
        "type": "box",
        "layout": "vertical",
        "contents": [
            {
                "type": "text",
                "text": f"Severity: {level}/15",
                "size": "xs",
                "color": "#888888"
            },
            {
                "type": "box",
                "layout": "horizontal",
                "contents": [
                    {
                        "type": "box",
                        "layout": "vertical",
                        "flex": progress,
                        "backgroundColor": "#FF0000" if level >= 12 else "#FFA500" if level >= 7 else "#00FF00",
                        "height": "6px"
                    },
                    {
                        "type": "box", 
                        "layout": "vertical",
                        "flex": 100 - progress,
                        "backgroundColor": "#E0E0E0",
                        "height": "6px"
                    }
                ]
            }
        ]
    }
```

---

## üìä Performance ‡πÅ‡∏•‡∏∞ Limitations

### ‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á LINE Flex Message
- **JSON Size**: ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ~10KB
- **Text Length**: ‡πÅ‡∏ï‡πà‡∏•‡∏∞ text element ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ~2000 characters
- **Nested Levels**: ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 levels
- **Elements**: ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 50 elements ‡∏ï‡πà‡∏≠ bubble

### Optimization Tips
- ‡πÉ‡∏ä‡πâ `smart_truncate()` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß
- ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á nested structure ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô
- ‡πÉ‡∏ä‡πâ `altText` ‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
- Test ‡∏Å‡∏±‡∏ö LINE Simulator ‡∏Å‡πà‡∏≠‡∏ô deploy

---

<div align="center">

**üé® Flex Message ‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á! üé®**

**üí° ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°? ‡∏î‡∏π source code ‡πÉ‡∏ô `create_flex_message()`**

**ü§ù ‡πÅ‡∏ä‡∏£‡πå design ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏±‡∏ö community!**

</div>